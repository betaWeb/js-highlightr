!function(t){var r={};function e(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}e.m=t,e.c=r,e.d=function(t,r,i){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var n in t)e.d(i,n,function(r){return t[r]}.bind(null,n));return i},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=0)}([function(t,r,e){t.exports=e(1)},function(t,r,e){const i=e(2);String.prototype.highlight||(String.prototype.highlight=function(t,r={}){return new i(r).highlight(this,t)}),Array.prototype.highlightMany||(Array.prototype.highlightMany=function(t,r={}){return new i(r).highlightMany(this,t)})},function(t,r,e){const i=e(3);t.exports=i},function(t,r){t.exports=class{constructor(t={}){this.setOptions(t)}highlight(t,r){if(!t)throw new Error("Highlight::highlight - context parameter is required and must be of type string");if(!r)throw new Error("Highlight::highlight - searchable parameter is required and must be of type string or array");if(r&&r.length){let e=this._prepare(r.trim());return 1===e.length||e.length>1&&this._belongsToContext(r,t)?this._highlightWord(t,r):e.reduce(this._highlightWord.bind(this),t)}return t}highlightMany(t,r){if(!t||!Array.isArray(t))throw new Error("Highlight::highlightMany - contextArray parameter must be of type array");return t.reduce((t,e)=>(t.push(this.highlight(e,r)),t),[])}setOptions(t={}){this._params={html_attrs:{},html_tag:"span",css_classes:"search__highlight",regexp:"__exp__",regexp_flags:"gi",word_min_length:2,...t}}_prepare(t){return(t.constructor===String?t.split(" "):t).filter((t,r,e)=>e.indexOf(t)===r).filter(t=>t.length>this._params.word_min_length).map(t=>t.trim())}_highlightWord(t,r,e=0){return t.replace(this._buildRegExp(r),this._buildTemplate(r,e))}_belongsToContext(t,r){return new RegExp(t,"gi").test(r)}_buildRegExp(t){return new RegExp(this._params.regexp.replace("__exp__",t),this._params.regexp_flags)}_buildTemplate(t,r){return`<${this._params.html_tag} class="${this._params.css_classes}" ${this._buildAttrs()} data-highlight="hl_${r+1}">${t}</${this._params.html_tag}>`}_buildAttrs(){if(!Object.keys(this._params.html_attrs).length)return" ";let t=[""];for(let r in this._params.html_attrs)this._params.html_attrs.hasOwnProperty(r)&&t.push(`${r}="${this._params.html_attrs[r]}"`);return t.join(" ")}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vYnJvd3Nlci5qcyIsIndlYnBhY2s6Ly8vLi9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJIaWdobGlnaHQiLCJTdHJpbmciLCJoaWdobGlnaHQiLCJzZWFyY2hhYmxlIiwib3B0aW9ucyIsInRoaXMiLCJBcnJheSIsImhpZ2hsaWdodE1hbnkiLCJIaWdobGlnaHRlciIsIltvYmplY3QgT2JqZWN0XSIsInNldE9wdGlvbnMiLCJjb250ZXh0IiwiRXJyb3IiLCJsZW5ndGgiLCJwYXJ0cyIsIl9wcmVwYXJlIiwidHJpbSIsIl9iZWxvbmdzVG9Db250ZXh0IiwiX2hpZ2hsaWdodFdvcmQiLCJyZWR1Y2UiLCJjb250ZXh0QXJyYXkiLCJpc0FycmF5IiwiYWNjIiwicHVzaCIsIl9wYXJhbXMiLCJodG1sX2F0dHJzIiwiaHRtbF90YWciLCJjc3NfY2xhc3NlcyIsInJlZ2V4cCIsInJlZ2V4cF9mbGFncyIsIndvcmRfbWluX2xlbmd0aCIsImNvbnN0cnVjdG9yIiwic3BsaXQiLCJmaWx0ZXIiLCJ2IiwiaW5kZXhPZiIsIm1hcCIsIndvcmQiLCJpbmRleCIsInJlcGxhY2UiLCJfYnVpbGRSZWdFeHAiLCJfYnVpbGRUZW1wbGF0ZSIsIlJlZ0V4cCIsInRlc3QiLCJfYnVpbGRBdHRycyIsImtleXMiLCJfYXR0cnMiLCJqb2luIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxFQUFBLEdBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsR0FBQSxDQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFFBQUEsSUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsRUFBQSxDQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFBYixFQUFBaUIsT0FBQUMsWUFBQSxDQUF3REMsTUFBQSxXQUV4RFAsT0FBQUMsZUFBQWIsRUFBQSxjQUFpRG1CLE9BQUEsS0FRakRyQixFQUFBc0IsRUFBQSxTQUFBRCxFQUFBRSxHQUVBLEdBREEsRUFBQUEsSUFBQUYsRUFBQXJCLEVBQUFxQixJQUNBLEVBQUFFLEVBQUEsT0FBQUYsRUFDQSxLQUFBRSxHQUFBLGlCQUFBRixRQUFBRyxXQUFBLE9BQUFILEVBQ0EsSUFBQUksRUFBQVgsT0FBQVksT0FBQSxNQUdBLEdBRkExQixFQUFBa0IsRUFBQU8sR0FDQVgsT0FBQUMsZUFBQVUsRUFBQSxXQUF5Q1QsWUFBQSxFQUFBSyxVQUN6QyxFQUFBRSxHQUFBLGlCQUFBRixFQUFBLFFBQUFNLEtBQUFOLEVBQUFyQixFQUFBVSxFQUFBZSxFQUFBRSxFQUFBLFNBQUFBLEdBQWdILE9B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QUFBNUIsZUFBQTdCLElBQ0E4RSxFQUFBdkIsUUFBK0J2RCxNQUFNcUMsS0FBQW1CLFFBQUFDLFdBQUF6RCxPQUdyQyxPQUFBOEUsRUFBQUMsS0FBQSIsImZpbGUiOiJoaWdobGlnaHRyLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImNvbnN0IEhpZ2hsaWdodCA9IHJlcXVpcmUoJy4vaW5kZXgnKVxuXG5pZiAoIVN0cmluZy5wcm90b3R5cGUuaGlnaGxpZ2h0KSB7XG4gICAgU3RyaW5nLnByb3RvdHlwZS5oaWdobGlnaHQgPSBmdW5jdGlvbihzZWFyY2hhYmxlLCBvcHRpb25zID0ge30pIHtcbiAgICAgICAgY29uc3QgX2luc3RhbmNlID0gbmV3IEhpZ2hsaWdodChvcHRpb25zKVxuICAgICAgICByZXR1cm4gX2luc3RhbmNlLmhpZ2hsaWdodCh0aGlzLCBzZWFyY2hhYmxlKVxuICAgIH1cbn1cblxuaWYgKCFBcnJheS5wcm90b3R5cGUuaGlnaGxpZ2h0TWFueSkge1xuICAgIEFycmF5LnByb3RvdHlwZS5oaWdobGlnaHRNYW55ID0gZnVuY3Rpb24oc2VhcmNoYWJsZSwgb3B0aW9ucyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IF9pbnN0YW5jZSA9IG5ldyBIaWdobGlnaHQob3B0aW9ucylcbiAgICAgICAgcmV0dXJuIF9pbnN0YW5jZS5oaWdobGlnaHRNYW55KHRoaXMsIHNlYXJjaGFibGUpXG4gICAgfVxufVxuIiwiY29uc3QgSGlnaGxpZ2h0ZXIgPSByZXF1aXJlKCcuL3NyYycpXG5tb2R1bGUuZXhwb3J0cyA9IEhpZ2hsaWdodGVyXG4iLCJjbGFzcyBIaWdobGlnaHRlciB7XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLmh0bWxfcGFyYW1zXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG9wdGlvbnMuaHRtbF90YWdcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gb3B0aW9ucy5jc3NfY2xhc3Nlc1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zLnJlZ2V4cFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zLnJlZ2V4cF9mbGFnc1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBvcHRpb25zLndvcmRfbWluX2xlbmd0aFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSkge1xuICAgICAgICB0aGlzLnNldE9wdGlvbnMob3B0aW9ucylcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIaWdobGlnaHQgYSB3b3JkIG9yIGEgZ3JvdXAgb2Ygd29yZHMgaW4gYSBzdHJpbmdcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjb250ZXh0XG4gICAgICogQHBhcmFtIHtTdHJpbmd8QXJyYXl9IHNlYXJjaGFibGVcbiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfVxuICAgICAqL1xuICAgIGhpZ2hsaWdodChjb250ZXh0LCBzZWFyY2hhYmxlKSB7XG4gICAgICAgIGlmICghY29udGV4dClcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSGlnaGxpZ2h0OjpoaWdobGlnaHQgLSBjb250ZXh0IHBhcmFtZXRlciBpcyByZXF1aXJlZCBhbmQgbXVzdCBiZSBvZiB0eXBlIHN0cmluZycpXG5cbiAgICAgICAgaWYgKCFzZWFyY2hhYmxlKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdIaWdobGlnaHQ6OmhpZ2hsaWdodCAtIHNlYXJjaGFibGUgcGFyYW1ldGVyIGlzIHJlcXVpcmVkIGFuZCBtdXN0IGJlIG9mIHR5cGUgc3RyaW5nIG9yIGFycmF5JylcblxuICAgICAgICBpZiAoc2VhcmNoYWJsZSAmJiBzZWFyY2hhYmxlLmxlbmd0aCkge1xuICAgICAgICAgICAgbGV0IHBhcnRzID0gdGhpcy5fcHJlcGFyZShzZWFyY2hhYmxlLnRyaW0oKSlcblxuICAgICAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMSB8fCAocGFydHMubGVuZ3RoID4gMSAmJiB0aGlzLl9iZWxvbmdzVG9Db250ZXh0KHNlYXJjaGFibGUsIGNvbnRleHQpKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9oaWdobGlnaHRXb3JkKGNvbnRleHQsIHNlYXJjaGFibGUpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBwYXJ0cy5yZWR1Y2UodGhpcy5faGlnaGxpZ2h0V29yZC5iaW5kKHRoaXMpLCBjb250ZXh0KVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbnRleHRcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIaWdobGlnaHQgYSB3b3JkIG9yIGEgZ3JvdXAgb2Ygd29yZHMgaW4gYW4gYXJyYXkgb2Ygc3RyaW5nXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ1tdfSBjb250ZXh0QXJyYXlcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gc2VhcmNoYWJsZVxuICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAqL1xuICAgIGhpZ2hsaWdodE1hbnkoY29udGV4dEFycmF5LCBzZWFyY2hhYmxlKSB7XG4gICAgICAgIGlmICghY29udGV4dEFycmF5IHx8ICFBcnJheS5pc0FycmF5KGNvbnRleHRBcnJheSkpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0hpZ2hsaWdodDo6aGlnaGxpZ2h0TWFueSAtIGNvbnRleHRBcnJheSBwYXJhbWV0ZXIgbXVzdCBiZSBvZiB0eXBlIGFycmF5JylcblxuICAgICAgICByZXR1cm4gY29udGV4dEFycmF5LnJlZHVjZSgoYWNjLCBjb250ZXh0KSA9PiB7XG4gICAgICAgICAgICBhY2MucHVzaCh0aGlzLmhpZ2hsaWdodChjb250ZXh0LCBzZWFyY2hhYmxlKSlcbiAgICAgICAgICAgIHJldHVybiBhY2NcbiAgICAgICAgfSwgW10pXG4gICAgfVxuXG4gICAgc2V0T3B0aW9ucyhvcHRpb25zID0ge30pIHtcbiAgICAgICAgdGhpcy5fcGFyYW1zID0ge1xuICAgICAgICAgICAgaHRtbF9hdHRyczoge30sXG4gICAgICAgICAgICBodG1sX3RhZzogJ3NwYW4nLFxuICAgICAgICAgICAgY3NzX2NsYXNzZXM6ICdzZWFyY2hfX2hpZ2hsaWdodCcsXG4gICAgICAgICAgICByZWdleHA6ICdfX2V4cF9fJyxcbiAgICAgICAgICAgIHJlZ2V4cF9mbGFnczogJ2dpJyxcbiAgICAgICAgICAgIHdvcmRfbWluX2xlbmd0aDogMixcbiAgICAgICAgICAgIC4uLm9wdGlvbnNcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9wcmVwYXJlKHNlYXJjaGFibGUpIHtcbiAgICAgICAgcmV0dXJuIChzZWFyY2hhYmxlLmNvbnN0cnVjdG9yID09PSBTdHJpbmcgPyBzZWFyY2hhYmxlLnNwbGl0KCcgJykgOiBzZWFyY2hhYmxlKVxuICAgICAgICAgICAgLmZpbHRlcigodiwgaSwgcykgPT4gcy5pbmRleE9mKHYpID09PSBpKVxuICAgICAgICAgICAgLmZpbHRlcih2ID0+IHYubGVuZ3RoID4gdGhpcy5fcGFyYW1zLndvcmRfbWluX2xlbmd0aClcbiAgICAgICAgICAgIC5tYXAoaSA9PiBpLnRyaW0oKSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIaWdobGlnaHQgd29yZCBpbiBhIHN0cmluZ1xuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGNvbnRleHRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gd29yZFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleFxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfaGlnaGxpZ2h0V29yZChjb250ZXh0LCB3b3JkLCBpbmRleCA9IDApIHtcbiAgICAgICAgcmV0dXJuIGNvbnRleHQucmVwbGFjZShcbiAgICAgICAgICAgIHRoaXMuX2J1aWxkUmVnRXhwKHdvcmQpLFxuICAgICAgICAgICAgdGhpcy5fYnVpbGRUZW1wbGF0ZSh3b3JkLCBpbmRleClcbiAgICAgICAgKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGNvbnRleHRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gc2VhcmNoYWJsZVxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2JlbG9uZ3NUb0NvbnRleHQoc2VhcmNoYWJsZSwgY29udGV4dCkge1xuICAgICAgICByZXR1cm4gKG5ldyBSZWdFeHAoc2VhcmNoYWJsZSwgJ2dpJykpLnRlc3QoY29udGV4dClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gd29yZFxuICAgICAqIEByZXR1cm5zIHtSZWdFeHB9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfYnVpbGRSZWdFeHAod29yZCkge1xuICAgICAgICByZXR1cm4gbmV3IFJlZ0V4cCh0aGlzLl9wYXJhbXMucmVnZXhwLnJlcGxhY2UoJ19fZXhwX18nLCB3b3JkKSwgdGhpcy5fcGFyYW1zLnJlZ2V4cF9mbGFncylcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gd29yZFxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleCB3b3JkIGluZGV4XG4gICAgICogQHJldHVybnMge3N0cmluZ31cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9idWlsZFRlbXBsYXRlKHdvcmQsIGluZGV4KSB7XG4gICAgICAgIHJldHVybiBgPCR7dGhpcy5fcGFyYW1zLmh0bWxfdGFnfSBjbGFzcz1cIiR7dGhpcy5fcGFyYW1zLmNzc19jbGFzc2VzfVwiICR7dGhpcy5fYnVpbGRBdHRycygpfSBkYXRhLWhpZ2hsaWdodD1cImhsXyR7aW5kZXggKyAxfVwiPiR7d29yZH08LyR7dGhpcy5fcGFyYW1zLmh0bWxfdGFnfT5gXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQnVpbGQgSFRNTCBhdHRyaWJ1dGVzXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2J1aWxkQXR0cnMoKSB7XG4gICAgICAgIGlmICghT2JqZWN0LmtleXModGhpcy5fcGFyYW1zLmh0bWxfYXR0cnMpLmxlbmd0aCkgcmV0dXJuICcgJ1xuICAgICAgICBsZXQgX2F0dHJzID0gWycnXVxuICAgICAgICBmb3IgKGxldCBpIGluIHRoaXMuX3BhcmFtcy5odG1sX2F0dHJzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcGFyYW1zLmh0bWxfYXR0cnMuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgICAgICAgICBfYXR0cnMucHVzaChgJHtpfT1cIiR7dGhpcy5fcGFyYW1zLmh0bWxfYXR0cnNbaV19XCJgKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfYXR0cnMuam9pbignICcpXG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEhpZ2hsaWdodGVyXG4iXSwic291cmNlUm9vdCI6IiJ9